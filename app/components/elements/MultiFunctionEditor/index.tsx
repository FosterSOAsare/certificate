import * as React from 'react'
import { Editor, EditorContent, useEditor } from '@tiptap/react'
import StarterKit from '@tiptap/starter-kit'

type MultiFunctionEditorProps = {
  onChange: (value: string) => void
  initValue?: string
}

const MultiFunctionEditor = (props: MultiFunctionEditorProps) => {
  const editor = useEditor({
    extensions: [StarterKit],
    onUpdate: ({ editor }) => {
      let text = editor.getHTML()

      if (text.length <= 240) {
        props.onChange(text)
      }
    },
    content: props.initValue || '',
  })

  return (
    <div className="border border-app-gray-100 rounded overflow-clip">
      <EditorMenuBar editor={editor} />
      <EditorContent editor={editor} className="p-4 min-h-[80px]" />
    </div>
  )
}

const EditorMenuBar = ({ editor }: { editor: Editor | null }) => {
  if (!editor) {
    return null
  }

  return (
    <div className="px-4 py-2 bg-app-stroke border-b-app-gray-100 border">
      <div className="flex items-center gap-4">
        <button
          type="button"
          onClick={() => editor.chain().focus().toggleBold().run()}
          className={`hover:bg-gray-300 h-full rounded-md p-1 transition-all duration-300 border-2 border-transparent ${
            editor.isActive('bold') ? 'border-black' : ''
          } `}
        >
          <svg
            width="28"
            height="28"
            viewBox="0 0 28 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M7.86142 22.417V21.8873C8.34853 21.6559 8.84782 21.5097 9.35929 21.4489V10.6167C9.11573 10.568 8.86609 10.5071 8.61036 10.4341C8.35462 10.3488 8.10498 10.2575 7.86142 10.1601V9.63035H9.79769C10.0291 9.63035 10.2483 9.62426 10.4553 9.61208C10.6745 9.5999 10.8998 9.58773 11.1312 9.57555C11.3625 9.56337 11.6122 9.55119 11.8801 9.53901C12.148 9.52684 12.4524 9.52075 12.7934 9.52075C13.2805 9.52075 13.7737 9.56337 14.273 9.64861C14.7845 9.72168 15.2411 9.86781 15.643 10.087C16.0571 10.3062 16.3919 10.6167 16.6477 11.0186C16.9034 11.4083 17.0313 11.9198 17.0313 12.553C17.0313 12.8696 16.9826 13.1863 16.8851 13.5029C16.7877 13.8195 16.6355 14.1179 16.4285 14.3979C16.2336 14.6659 15.984 14.9033 15.6795 15.1103C15.3751 15.3174 15.0159 15.4696 14.6018 15.567V15.6401C14.9671 15.701 15.3264 15.8045 15.6795 15.9506C16.0449 16.0967 16.3676 16.2977 16.6477 16.5534C16.9278 16.797 17.1531 17.1014 17.3235 17.4667C17.5062 17.8321 17.5975 18.2705 17.5975 18.7819C17.5975 19.4395 17.4514 20.0058 17.1591 20.4807C16.8669 20.9557 16.4833 21.3453 16.0083 21.6498C15.5456 21.9542 15.0159 22.1795 14.4191 22.3257C13.8224 22.4596 13.2196 22.5266 12.6107 22.5266C12.1845 22.5266 11.7035 22.5083 11.1677 22.4718C10.6319 22.4353 10.1143 22.417 9.61502 22.417H7.86142ZM12.7386 21.5767C13.177 21.5767 13.585 21.5097 13.9625 21.3758C14.3522 21.2418 14.681 21.0592 14.9489 20.8278C15.229 20.5842 15.4482 20.2981 15.6065 19.9693C15.7648 19.6283 15.8439 19.263 15.8439 18.8733C15.8439 18.3862 15.7465 17.9843 15.5517 17.6677C15.369 17.3389 15.1133 17.0831 14.7845 16.9005C14.4679 16.7056 14.0964 16.5717 13.6702 16.4986C13.2562 16.4255 12.8239 16.389 12.3733 16.389H11.0033V21.4306C11.1738 21.4793 11.3747 21.5158 11.6061 21.5402C11.8496 21.5645 12.2271 21.5767 12.7386 21.5767ZM11.9166 15.4391C12.1236 15.4391 12.3672 15.433 12.6473 15.4209C12.9395 15.3965 13.177 15.3722 13.3597 15.3478C13.9199 15.153 14.3765 14.8424 14.7297 14.4162C15.095 13.9778 15.2777 13.4663 15.2777 12.8818C15.2777 12.0781 15.0341 11.4753 14.547 11.0734C14.0721 10.6715 13.4327 10.4706 12.629 10.4706C12.2515 10.4706 11.9288 10.4767 11.6609 10.4889C11.393 10.5011 11.1738 10.5193 11.0033 10.5437V15.4391H11.9166Z"
              fill="#2F2D37"
            />
          </svg>
        </button>

        <button
          type="button"
          onClick={() => editor.chain().focus().toggleItalic().run()}
          className={`hover:bg-gray-300 h-full rounded-md p-1 transition-all duration-300 border-2 border-transparent ${
            editor.isActive('italic') ? 'border-black' : ''
          }`}
        >
          <svg
            width="28"
            height="28"
            viewBox="0 0 28 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M14.7907 22.417H10.1144L10.2057 21.8873C10.7416 21.6681 11.2652 21.5219 11.7767 21.4489L14.06 10.6167C13.8164 10.568 13.5851 10.5071 13.3659 10.4341C13.1467 10.3488 12.9214 10.2575 12.69 10.1601L12.8179 9.63035H17.4941L17.3845 10.1601C17.141 10.2575 16.8791 10.3488 16.5991 10.4341C16.319 10.5071 16.0571 10.568 15.8136 10.6167L13.5303 21.4489C13.7738 21.4976 14.0113 21.5585 14.2427 21.6315C14.4862 21.7046 14.6993 21.7898 14.882 21.8873L14.7907 22.417Z"
              fill="#2F2D37"
            />
          </svg>
        </button>

        <button
          type="button"
          onClick={() => editor.chain().focus().toggleStrike().run()}
          className={`hover:bg-gray-300 h-full rounded-md p-1 transition-all duration-300 border-2 border-transparent ${
            editor.isActive('strike') ? 'border-black' : ''
          }`}
        >
          <svg
            width="28"
            height="28"
            viewBox="0 0 28 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M9.79024 21.1566C9.93637 21.3027 10.1251 21.4306 10.3565 21.5402C10.5879 21.6376 10.9349 21.6863 11.3977 21.6863C11.7874 21.6863 12.1527 21.6376 12.4937 21.5402C12.8347 21.4306 13.1269 21.2784 13.3705 21.0835C13.6262 20.8765 13.8272 20.633 13.9733 20.3529C14.1194 20.0606 14.1925 19.7318 14.1925 19.3665C14.1925 18.8794 14.0403 18.4714 13.7358 18.1426C13.4436 17.8138 13.0721 17.5215 12.6216 17.2658C12.1832 17.0101 11.7021 16.7604 11.1785 16.5169C10.6549 16.2733 10.1678 15.9871 9.71717 15.6583C9.27877 15.3174 8.90735 14.9155 8.60291 14.4527C8.31064 13.9778 8.16451 13.3872 8.16451 12.6809C8.16451 12.1694 8.25584 11.7127 8.43851 11.3109C8.62118 10.909 8.87691 10.568 9.20571 10.2879C9.54669 10.0079 9.94855 9.79475 10.4113 9.64861C10.8741 9.4903 11.3916 9.41115 11.964 9.41115C12.7068 9.41115 13.3827 9.47204 13.9916 9.59381C14.6126 9.70341 15.0997 9.84346 15.4529 10.0139C15.4529 10.221 15.4346 10.4645 15.3981 10.7446C15.3737 11.0125 15.3372 11.2926 15.2885 11.5849C15.252 11.8771 15.2093 12.1633 15.1606 12.4434C15.1119 12.7113 15.0632 12.9488 15.0145 13.1558H14.5396L13.8089 10.6533C13.5897 10.5559 13.3096 10.4828 12.9686 10.4341C12.6398 10.3854 12.2867 10.361 11.9092 10.361C11.2881 10.361 10.7888 10.5376 10.4113 10.8907C10.0338 11.2317 9.84504 11.7127 9.84504 12.3338C9.84504 12.8331 9.99117 13.2532 10.2834 13.5942C10.5879 13.9352 10.9654 14.2396 11.416 14.5075C11.8665 14.7754 12.3476 15.0373 12.859 15.293C13.3827 15.5366 13.8698 15.8227 14.3204 16.1515C14.7709 16.4803 15.1424 16.87 15.4346 17.3206C15.7391 17.7712 15.8913 18.3314 15.8913 19.0011C15.8913 19.5491 15.7878 20.0484 15.5808 20.499C15.3859 20.9496 15.0997 21.3332 14.7222 21.6498C14.3447 21.9664 13.882 22.21 13.334 22.3805C12.786 22.5509 12.1649 22.6362 11.4708 22.6362C10.7036 22.6362 10.0155 22.5449 9.40664 22.3622C8.79775 22.1795 8.36544 21.9847 8.10971 21.7777C8.12189 21.5706 8.14015 21.321 8.16451 21.0287C8.20104 20.7365 8.23758 20.4381 8.27411 20.1337C8.32282 19.817 8.37153 19.5126 8.42024 19.2203C8.46895 18.9281 8.51766 18.6784 8.56638 18.4714H9.04131L9.79024 21.1566Z"
              fill="#2F2D37"
            />
            <path
              d="M7.05025 17.8503H16.8412V18.7637H7.05025V17.8503Z"
              fill="#2F2D37"
            />
          </svg>
        </button>

        <button
          type="button"
          onClick={() => editor.chain().toggleCodeBlock().run()}
          className={`hover:bg-gray-300 h-full rounded-md p-1 transition-all duration-300 border-2 border-transparent `}
        >
          <svg
            width="28"
            height="28"
            viewBox="0 0 28 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <g clipPath="url(#clip0_5526_6925)">
              <path
                d="M8.86253 19.5536L3.47656 14.8409L8.86253 10.1281M16.9415 19.5536L22.3275 14.8409L16.9415 10.1281M14.9217 8.1084L10.8823 21.5733"
                stroke="#2F2D37"
                strokeWidth="1.34649"
                strokeLinecap="round"
                strokeLinejoin="round"
              />
            </g>
            <defs>
              <clipPath id="clip0_5526_6925">
                <rect
                  width="21.5439"
                  height="21.5439"
                  fill="white"
                  transform="translate(2.12891 4.06934)"
                />
              </clipPath>
            </defs>
          </svg>
        </button>

        <button
          type="button"
          onClick={() => editor.chain().focus().toggleBulletList().run()}
          className={`hover:bg-gray-300 h-full rounded-md p-1 transition-all duration-300 border-2 border-transparent ${
            editor.isActive('bulletList') ? 'border-black' : ''
          }`}
        >
          <svg
            width="28"
            height="28"
            viewBox="0 0 28 26"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M9.26953 18.784H23.3106M9.26953 7.0957H23.3106H9.26953ZM9.26953 12.9399H23.3106H9.26953Z"
              stroke="#2F2D37"
              strokeWidth="1.47963"
              strokeLinecap="round"
              strokeLinejoin="round"
            />
            <path
              d="M5.32069 8.05455C5.74158 8.05455 6.08279 7.71726 6.08279 7.3012C6.08279 6.88514 5.74158 6.54785 5.32069 6.54785C4.8998 6.54785 4.55859 6.88514 4.55859 7.3012C4.55859 7.71726 4.8998 8.05455 5.32069 8.05455Z"
              stroke="#2F2D37"
              strokeWidth="1.56193"
              strokeLinecap="round"
              strokeLinejoin="round"
            />
            <path
              d="M5.32069 13.7167C5.74158 13.7167 6.08279 13.3794 6.08279 12.9633C6.08279 12.5472 5.74158 12.21 5.32069 12.21C4.8998 12.21 4.55859 12.5472 4.55859 12.9633C4.55859 13.3794 4.8998 13.7167 5.32069 13.7167Z"
              stroke="#2F2D37"
              strokeWidth="1.56193"
              strokeLinecap="round"
              strokeLinejoin="round"
            />
            <path
              d="M5.32069 19.3329C5.74158 19.3329 6.08279 18.9956 6.08279 18.5795C6.08279 18.1635 5.74158 17.8262 5.32069 17.8262C4.8998 17.8262 4.55859 18.1635 4.55859 18.5795C4.55859 18.9956 4.8998 19.3329 5.32069 19.3329Z"
              stroke="#2F2D37"
              strokeWidth="1.56193"
              strokeLinecap="round"
              strokeLinejoin="round"
            />
          </svg>
        </button>

        <button
          type="button"
          onClick={() => editor.chain().focus().toggleOrderedList().run()}
          className={`hover:bg-gray-300 h-full rounded-md p-1 transition-all duration-300 border-2 border-transparent ${
            editor.isActive('orderedList') ? 'border-black' : ''
          }`}
        >
          <svg
            width="30"
            height="27"
            viewBox="0 0 30 27"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M11.332 9.4502H20.9496M11.332 18.3279H20.9496"
              stroke="#2F2D37"
              strokeWidth="2.21944"
              strokeLinecap="round"
              strokeLinejoin="round"
            />
            <path
              d="M5.50029 11.6925C5.89404 11.6925 6.15774 11.436 6.15774 11.0386V7.05418C6.15774 6.59902 5.87959 6.31365 5.40275 6.31365C5.14266 6.31365 4.9187 6.34254 4.64055 6.53039L3.65437 7.20229C3.46653 7.33233 3.39067 7.48044 3.39067 7.6719C3.39067 7.93921 3.58212 8.13067 3.8386 8.13067C3.96503 8.13067 4.0445 8.10177 4.16371 8.01868L4.81394 7.56714H4.83923V11.0386C4.83923 11.436 5.10654 11.6925 5.50029 11.6925Z"
              fill="#2F2D37"
            />
            <path
              d="M4.08701 21.1504H6.9769C7.31285 21.1504 7.50792 20.9445 7.50792 20.641C7.50792 20.3304 7.31285 20.1317 6.9769 20.1317H5.17433V20.1064L6.21108 19.16C7.03831 18.4122 7.37788 18.0293 7.37788 17.361C7.37788 16.4399 6.59761 15.8077 5.40914 15.8077C4.45909 15.8077 3.76551 16.2665 3.53793 16.8661C3.4982 16.96 3.48375 17.054 3.48375 17.1551C3.48375 17.4802 3.68965 17.6789 4.03283 17.6789C4.30014 17.6789 4.45547 17.5741 4.62164 17.3177C4.8131 16.9709 5.0479 16.8047 5.39108 16.8047C5.8065 16.8047 6.09549 17.072 6.09549 17.4477C6.09549 17.7873 5.92932 18.0257 5.31883 18.582L3.83053 19.933C3.57044 20.157 3.46568 20.334 3.46568 20.5832C3.46568 20.912 3.66075 21.1504 4.08701 21.1504Z"
              fill="#2F2D37"
            />
          </svg>
        </button>
      </div>
    </div>
  )
}

export default MultiFunctionEditor
